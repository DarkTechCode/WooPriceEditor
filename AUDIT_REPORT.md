# üîç –û—Ç—á—ë—Ç –ø–æ –∞—É–¥–∏—Ç—É WooEditPrice Demo

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** –î–µ–∫–∞–±—Ä—å 2024  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–≤—Ç–æ—Ä:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –¥–ª—è —Ä–µ–≤—å—é

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–†–µ–∑—é–º–µ](#—Ä–µ–∑—é–º–µ)
2. [–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã](#–∞–Ω–∞–ª–∏–∑-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
3. [–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
4. [–ë–∞–≥–∏ –∏ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∏–∫–µ](#–±–∞–≥–∏-–∏-–æ—à–∏–±–∫–∏-–≤-–ª–æ–≥–∏–∫–µ)
5. [–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏](#–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
6. [–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞](#–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ-–∫–æ–¥–∞)
7. [–£—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–æ–¥](#—É—Å—Ç–∞—Ä–µ–≤—à–∏–π-–∫–æ–¥)
8. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
9. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É –¥–ª—è WordPress –ø–ª–∞–≥–∏–Ω–∞](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É-–¥–ª—è-wordpress-–ø–ª–∞–≥–∏–Ω–∞)
10. [–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π](#–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π-–ø–ª–∞–Ω-–¥–µ–π—Å—Ç–≤–∏–π)

---

## üìå –†–µ–∑—é–º–µ

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –ê—Å–ø–µ–∫—Ç | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|--------|-------------|
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | ‚≠ê‚≠ê‚≠ê‚≠ê | –•–æ—Ä–æ—à–∞—è –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ JS |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | ‚≠ê‚≠ê‚ö´‚ö´ | –¢—Ä–µ–±—É–µ—Ç —Å–µ—Ä—å—ë–∑–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | ‚≠ê‚≠ê‚≠ê‚ö´ | –ï—Å—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ |
| –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ | ‚≠ê‚≠ê‚≠ê‚ö´ | –ß–∏—Å—Ç—ã–π –∫–æ–¥, –Ω–æ –µ—Å—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ |
| –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | ‚≠ê‚≠ê‚≠ê‚≠ê | –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏

- ‚úÖ **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:** –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ JS, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ CSS, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DataTables
- ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL
- üö´ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ nonce –ø—Ä–æ–≤–µ—Ä–∫–∏, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ SQL injection

---

## üìÅ –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –¢–µ–∫—É—â–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
‚îú‚îÄ‚îÄ index.php                 # –ù–∞–≤–∏–≥–∞—Ü–∏—è (–∏–∑–±—ã—Ç–æ—á–µ–Ω –¥–ª—è –ø–ª–∞–≥–∏–Ω–∞)
‚îú‚îÄ‚îÄ price_editor.php          # –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ standalone_api.php    # –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π API (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ css/                  # 14 CSS —Ñ–∞–π–ª–æ–≤ (–º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ header.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filters.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ column-manager.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ table.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ editing.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ statuses.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ links-buttons.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ system.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ errors.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ indicators.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ datatables-custom.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ responsive.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jquery.dataTables.min.css
‚îÇ   ‚îî‚îÄ‚îÄ js/                   # 8 JS —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ price_editor.js        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ       ‚îú‚îÄ‚îÄ price_editor.core.js   # –Ø–¥—Ä–æ
‚îÇ       ‚îú‚îÄ‚îÄ price_editor.data.js   # –†–∞–±–æ—Ç–∞ —Å API
‚îÇ       ‚îú‚îÄ‚îÄ price_editor.editing.js # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ       ‚îú‚îÄ‚îÄ price_editor.ui.js     # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ price_editor.filters.js # –§–∏–ª—å—Ç—Ä—ã
‚îÇ       ‚îú‚îÄ‚îÄ jquery-3.6.0.min.js    # jQuery (–Ω–µ –Ω—É–∂–µ–Ω)
‚îÇ       ‚îú‚îÄ‚îÄ jquery.dataTables.min.js # DataTables
‚îÇ       ‚îî‚îÄ‚îÄ datatables_ru.json     # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

| –ü—Ä–æ–±–ª–µ–º–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----------|----------|-----------|
| –õ–∏—à–Ω–∏–π jQuery | WordPress –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π jQuery | üî¥ –í—ã—Å–æ–∫–∏–π |
| –ú–Ω–æ–≥–æ CSS —Ñ–∞–π–ª–æ–≤ | 14 —Ñ–∞–π–ª–æ–≤ = 14 HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ | üü° –°—Ä–µ–¥–Ω–∏–π |
| Standalone API | –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Ñ–∞–π–ª –±–µ–∑ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è | üü° –°—Ä–µ–¥–Ω–∏–π |
| index.php | –ù–µ –Ω—É–∂–µ–Ω –¥–ª—è WordPress –ø–ª–∞–≥–∏–Ω–∞ | üü¢ –ù–∏–∑–∫–∏–π |

---

## üîí –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (P0)

#### 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã

```php
// ‚ùå –¢–ï–ö–£–©–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ nonce
$action = sanitize_text_field($_POST['action'] ?? '');

// ‚úÖ –î–û–õ–ñ–ù–û –ë–´–¢–¨
$action = sanitize_text_field($_POST['action'] ?? '');
if (!wp_verify_nonce($_POST['_wpnonce'], 'woo_price_editor_action')) {
    wp_send_json_error(['message' => 'Security check failed']);
}
```

**–†–∏—Å–∫:** –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç –∏–º–µ–Ω–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### 2. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π SQL Injection –≤ –ø–æ–∏—Å–∫–µ

```php
// ‚ö†Ô∏è –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
// –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ $wpdb->prepare() –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ search

// ‚ùå –û–ø–∞—Å–Ω–æ
$sql = "SELECT * FROM {$wpdb->posts} WHERE post_title LIKE '%{$search}%'";

// ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ
$sql = $wpdb->prepare(
    "SELECT * FROM {$wpdb->posts} WHERE post_title LIKE %s",
    '%' . $wpdb->esc_like($search) . '%'
);
```

#### 3. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```php
// ‚ùå –¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
if (!current_user_can('manage_woocommerce')) {
    wp_die(__('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.'));
}

// ‚úÖ –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–∞–∂–¥–æ–º API endpoint
function handle_api_request() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    if (!is_user_logged_in()) {
        wp_send_json_error(['message' => 'Not authenticated'], 401);
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
    if (!current_user_can('manage_woocommerce')) {
        wp_send_json_error(['message' => 'Not authorized'], 403);
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ nonce
    check_ajax_referer('woo_price_editor_nonce', '_wpnonce');
}
```

### –í—ã—Å–æ–∫–∏–µ (P1)

#### 4. XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

```javascript
// ‚ùå –û–ü–ê–°–ù–û - –ø—Ä—è–º–∞—è –≤—Å—Ç–∞–≤–∫–∞ HTML
$cell.html('<span class="product-title">' + data.title + '</span>');

// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û - —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}
$cell.html('<span class="product-title">' + escapeHtml(data.title) + '</span>');
```

#### 5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting

```php
// ‚ùå –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
// API –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞DDoS'–µ–Ω

// ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limiting
function check_rate_limit() {
    $user_id = get_current_user_id();
    $key = 'wpe_rate_' . $user_id;
    $count = get_transient($key) ?: 0;
    
    if ($count > 100) { // 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
        wp_send_json_error(['message' => 'Rate limit exceeded'], 429);
    }
    
    set_transient($key, $count + 1, MINUTE_IN_SECONDS);
}
```

### –°—Ä–µ–¥–Ω–∏–µ (P2)

#### 6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π

```php
// ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—É–¥–∏—Ç –ª–æ–≥
$product->save();

// ‚úÖ –° –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
$old_value = $product->get_regular_price();
$product->set_regular_price($new_value);
$product->save();

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
do_action('woo_price_editor_product_updated', [
    'product_id' => $product_id,
    'field' => 'regular_price',
    'old_value' => $old_value,
    'new_value' => $new_value,
    'user_id' => get_current_user_id(),
    'timestamp' => current_time('mysql')
]);
```

---

## üêõ –ë–∞–≥–∏ –∏ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∏–∫–µ

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

```javascript
// ‚ùå –¢–ï–ö–£–©–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ)
$.ajax({
    url: apiUrl,
    success: function(response) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—Ö–∞
    },
    error: function() {
        console.log('Error');
    }
});

// ‚úÖ –î–û–õ–ñ–ù–û –ë–´–¢–¨
$.ajax({
    url: apiUrl,
    success: function(response) {
        if (response.success) {
            handleSuccess(response.data);
        } else {
            handleError(response.message || 'Unknown error');
        }
    },
    error: function(xhr, status, error) {
        handleNetworkError({
            status: xhr.status,
            statusText: xhr.statusText,
            responseText: xhr.responseText
        });
    },
    timeout: 30000 // –¢–∞–π–º–∞—É—Ç 30 —Å–µ–∫—É–Ω–¥
});
```

### 2. Race Conditions –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

```javascript
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
$input.on('blur', function() {
    saveField(productId, field, value);
});

// ‚úÖ –†–ï–®–ï–ù–ò–ï - debounce –∏ –æ—Ç–º–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
let saveRequests = {};

function saveFieldDebounced(productId, field, value) {
    const key = `${productId}_${field}`;
    
    // –û—Ç–º–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
    if (saveRequests[key]) {
        saveRequests[key].abort();
    }
    
    // Debounce
    clearTimeout(saveRequests[key + '_timeout']);
    saveRequests[key + '_timeout'] = setTimeout(() => {
        saveRequests[key] = $.ajax({
            // ... –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
        });
    }, 300);
}
```

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ü–µ–Ω

```javascript
// ‚ùå –ù–ï–¢ –í–ê–õ–ò–î–ê–¶–ò–ò
function savePrice(productId, price) {
    // –ü—Ä—è–º–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
}

// ‚úÖ –° –í–ê–õ–ò–î–ê–¶–ò–ï–ô
function validatePrice(price) {
    // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –∑–∞–º–µ–Ω–∞ –∑–∞–ø—è—Ç–æ–π –Ω–∞ —Ç–æ—á–∫—É
    price = String(price).trim().replace(',', '.');
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —á–∏—Å–ª–æ
    const numPrice = parseFloat(price);
    
    if (isNaN(numPrice)) {
        return { valid: false, error: '–¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —á–∏—Å–ª–æ–º' };
    }
    
    if (numPrice < 0) {
        return { valid: false, error: '–¶–µ–Ω–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π' };
    }
    
    if (numPrice > 999999999.99) {
        return { valid: false, error: '–¶–µ–Ω–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∞—è' };
    }
    
    return { valid: true, value: numPrice.toFixed(2) };
}
```

### 4. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Å—Ç–æ–π sale_price

```php
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê - –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ vs null
case 'sale_price':
    $product->set_sale_price($value);
    break;

// ‚úÖ –†–ï–®–ï–ù–ò–ï
case 'sale_price':
    // –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –æ–∑–Ω–∞—á–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ —Å–∫–∏–¥–∫–∏
    $value = trim($value);
    if ($value === '') {
        $product->set_sale_price('');
    } else {
        $price = wc_format_decimal($value);
        if ($price < 0) {
            throw new Exception('–¶–µ–Ω–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π');
        }
        $product->set_sale_price($price);
    }
    break;
```

### 5. –ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ UI

```javascript
// ‚ùå UI –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –¥–∞–Ω–Ω—ã–º–∏
function updateCell(productId, field, newValue) {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–∞, –Ω–µ data-–∞—Ç—Ä–∏–±—É—Ç–æ–≤
    $cell.text(newValue);
}

// ‚úÖ –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
function updateCell(productId, field, newValue) {
    const $row = $(`tr[data-product-id="${productId}"]`);
    const $cell = $row.find(`td[data-field="${field}"]`);
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    $cell.find('.display-value').text(newValue);
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ data-–∞—Ç—Ä–∏–±—É—Ç–æ–≤
    $cell.attr('data-value', newValue);
    $cell.attr('data-original-value', newValue);
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö DataTables
    const table = $('#products-table').DataTable();
    const rowData = table.row($row).data();
    rowData[field] = newValue;
    table.row($row).data(rowData).draw(false);
}
```

---

## ‚ö° –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –û—Ç–∫–ª—é—á—ë–Ω–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è

```javascript
// ‚ùå –¢–ï–ö–£–©–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø
paging: false,  // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤

// üî¥ –ü–†–û–ë–õ–ï–ú–ê: –ü—Ä–∏ 10,000+ —Ç–æ–≤–∞—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≤–∏—Å–Ω–µ—Ç

// ‚úÖ –†–ï–®–ï–ù–ò–ï - —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è
{
    serverSide: true,
    processing: true,
    paging: true,
    pageLength: 50,
    ajax: {
        url: apiUrl,
        type: 'POST',
        data: function(d) {
            return {
                action: 'get_products',
                draw: d.draw,
                start: d.start,
                length: d.length,
                search: d.search.value,
                order: d.order,
                _wpnonce: wpNonce
            };
        }
    }
}
```

### 2. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ CSS —Ñ–∞–π–ª—ã

```html
<!-- ‚ùå –¢–ï–ö–£–©–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø - 14 –∑–∞–ø—Ä–æ—Å–æ–≤ -->
<link rel="stylesheet" href="assets/css/base.css">
<link rel="stylesheet" href="assets/css/header.css">
<link rel="stylesheet" href="assets/css/filters.css">
<!-- ... –µ—â—ë 11 —Ñ–∞–π–ª–æ–≤ -->

<!-- ‚úÖ –†–ï–®–ï–ù–ò–ï - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤ production -->
<link rel="stylesheet" href="assets/css/price-editor.min.css">
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–±–æ—Ä—â–∏–∫ (Webpack/Gulp) –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### 3. –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã

```php
// ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–æ JOIN'–æ–≤
SELECT DISTINCT p.ID, p.post_title, p.post_status,
       pm_sku.meta_value as sku,
       pm_price.meta_value as regular_price,
       pm_sale.meta_value as sale_price,
       pm_tax_status.meta_value as tax_status,
       pm_tax_class.meta_value as tax_class,
       pm_stock_status.meta_value as stock_status
FROM {$wpdb->posts} p
LEFT JOIN {$wpdb->postmeta} pm_sku ON p.ID = pm_sku.post_id AND pm_sku.meta_key = '_sku'
LEFT JOIN {$wpdb->postmeta} pm_price ON p.ID = pm_price.post_id AND pm_price.meta_key = '_regular_price'
LEFT JOIN {$wpdb->postmeta} pm_sale ON p.ID = pm_sale.post_id AND pm_sale.meta_key = '_sale_price'
LEFT JOIN {$wpdb->postmeta} pm_tax_status ON p.ID = pm_tax_status.post_id AND pm_tax_status.meta_key = '_tax_status'
LEFT JOIN {$wpdb->postmeta} pm_tax_class ON p.ID = pm_tax_class.post_id AND pm_tax_class.meta_key = '_tax_class'
LEFT JOIN {$wpdb->postmeta} pm_stock_status ON p.ID = pm_stock_status.post_id AND pm_stock_status.meta_key = '_stock_status'

// ‚úÖ –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WC_Product_Query
$args = [
    'status' => ['publish', 'draft', 'private'],
    'limit' => 50,
    'page' => $page,
    'orderby' => 'ID',
    'order' => 'DESC',
    'return' => 'objects'
];

if (!empty($category)) {
    $args['category'] = [$category];
}

if (!empty($search)) {
    $args['s'] = $search;
}

$query = new WC_Product_Query($args);
$products = $query->get_products();
```

### 4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

```php
// ‚ùå –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ SQL
function get_categories() {
    // –ó–∞–ø—Ä–æ—Å –∫ –ë–î –∫–∞–∂–¥—ã–π —Ä–∞–∑
}

// ‚úÖ –° –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
function get_categories() {
    $cache_key = 'wpe_product_categories';
    $categories = wp_cache_get($cache_key);
    
    if ($categories === false) {
        $categories = get_terms([
            'taxonomy' => 'product_cat',
            'hide_empty' => false
        ]);
        wp_cache_set($cache_key, $categories, '', HOUR_IN_SECONDS);
    }
    
    return $categories;
}
```

### 5. DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –≤ —Ü–∏–∫–ª–µ

```javascript
// ‚ùå –ú–ï–î–õ–ï–ù–ù–û - –∏–∑–º–µ–Ω–µ–Ω–∏–µ DOM –≤ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
products.forEach(product => {
    $('#products-table tbody').append(createRow(product));
});

// ‚úÖ –ë–´–°–¢–†–û - batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
const rows = products.map(product => createRow(product));
$('#products-table tbody').append(rows.join(''));

// –ò–õ–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DocumentFragment
const fragment = document.createDocumentFragment();
products.forEach(product => {
    fragment.appendChild(createRowElement(product));
});
document.querySelector('#products-table tbody').appendChild(fragment);
```

---

## üîÅ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã—Ö –ø–æ–ª–µ–π

```javascript
// ‚ùå –î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï - –ø–æ—Ö–æ–∂–∏–π –∫–æ–¥ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π
function createPriceField(productId, price) {
    return `<input type="text" class="price-input" data-product-id="${productId}" value="${price}">`;
}

function createTitleField(productId, title) {
    return `<input type="text" class="title-input" data-product-id="${productId}" value="${title}">`;
}

function createSkuField(productId, sku) {
    return `<input type="text" class="sku-input" data-product-id="${productId}" value="${sku}">`;
}

// ‚úÖ –ï–î–ò–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
function createEditableField(config) {
    const {
        productId,
        field,
        value,
        type = 'text',
        className = '',
        attributes = {}
    } = config;
    
    const attrs = Object.entries(attributes)
        .map(([key, val]) => `${key}="${escapeAttr(val)}"`)
        .join(' ');
    
    return `<input 
        type="${type}" 
        class="editable-field ${field}-input ${className}" 
        data-product-id="${productId}"
        data-field="${field}"
        value="${escapeAttr(value)}"
        ${attrs}
    >`;
}
```

### 2. AJAX –∑–∞–ø—Ä–æ—Å—ã

```javascript
// ‚ùå –î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï –≤ –∫–∞–∂–¥–æ–º –º–æ–¥—É–ª–µ
// data.js
$.ajax({
    url: apiUrl,
    type: 'POST',
    dataType: 'json',
    data: { action: 'get_products', ... }
});

// editing.js
$.ajax({
    url: apiUrl,
    type: 'POST',
    dataType: 'json',
    data: { action: 'update_product', ... }
});

// ‚úÖ –ï–î–ò–ù–´–ô API –ö–õ–ò–ï–ù–¢
const ApiClient = {
    baseUrl: '/api/standalone_api.php',
    
    request(action, data = {}) {
        return $.ajax({
            url: this.baseUrl,
            type: 'POST',
            dataType: 'json',
            data: {
                action,
                _wpnonce: this.nonce,
                ...data
            }
        }).fail(this.handleError);
    },
    
    handleError(xhr, status, error) {
        console.error('API Error:', { xhr, status, error });
        UIModule.showError('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
    },
    
    getProducts(filters) {
        return this.request('get_products', filters);
    },
    
    updateProduct(productId, field, value) {
        return this.request('update_product', { product_id: productId, field, value });
    },
    
    getCategories() {
        return this.request('get_categories');
    },
    
    getTaxClasses() {
        return this.request('get_tax_classes');
    }
};
```

### 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π

```javascript
// ‚ùå –ü–æ—Ö–æ–∂–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö select'–æ–≤
$('#status-filter').on('change', function() {
    const value = $(this).val();
    applyFilter('status', value);
    reloadTable();
});

$('#category-filter').on('change', function() {
    const value = $(this).val();
    applyFilter('category', value);
    reloadTable();
});

$('#tax-filter').on('change', function() {
    const value = $(this).val();
    applyFilter('tax_status', value);
    reloadTable();
});

// ‚úÖ –ï–î–ò–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö
$('.filter-select').on('change', function() {
    const $select = $(this);
    const filterName = $select.data('filter');
    const value = $select.val();
    
    applyFilter(filterName, value);
    reloadTable();
});
```

### 4. PHP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ API

```php
// ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ switch/case
switch ($field) {
    case 'regular_price':
        $old = $product->get_regular_price();
        $product->set_regular_price($value);
        $message = "–û–±—ã—á–Ω–∞—è —Ü–µ–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∞: {$old} ‚Üí {$value}";
        break;
    case 'sale_price':
        $old = $product->get_sale_price();
        $product->set_sale_price($value);
        $message = "–¶–µ–Ω–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π –∏–∑–º–µ–Ω–µ–Ω–∞: {$old} ‚Üí {$value}";
        break;
    // ... –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω
}

// ‚úÖ –ö–û–ù–§–ò–ì–£–†–ò–†–£–ï–ú–´–ô –ü–û–î–•–û–î
$field_config = [
    'regular_price' => [
        'getter' => 'get_regular_price',
        'setter' => 'set_regular_price',
        'label' => '–û–±—ã—á–Ω–∞—è —Ü–µ–Ω–∞',
        'sanitize' => 'wc_format_decimal'
    ],
    'sale_price' => [
        'getter' => 'get_sale_price',
        'setter' => 'set_sale_price',
        'label' => '–¶–µ–Ω–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π',
        'sanitize' => 'wc_format_decimal'
    ],
    'title' => [
        'getter' => 'get_name',
        'setter' => 'set_name',
        'label' => '–ù–∞–∑–≤–∞–Ω–∏–µ',
        'sanitize' => 'sanitize_text_field'
    ],
    // ...
];

if (!isset($field_config[$field])) {
    throw new Exception("Unknown field: {$field}");
}

$config = $field_config[$field];
$old_value = call_user_func([$product, $config['getter']]);
$sanitized = call_user_func($config['sanitize'], $value);
call_user_func([$product, $config['setter']], $sanitized);
$message = "{$config['label']} –∏–∑–º–µ–Ω–µ–Ω–∞: {$old_value} ‚Üí {$sanitized}";
```

---

## üóëÔ∏è –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–æ–¥

### –ö–æ–¥ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

| –§–∞–π–ª/–ö–æ–¥ | –ü—Ä–∏—á–∏–Ω–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
|----------|---------|----------|
| `jquery-3.6.0.min.js` | WordPress –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π jQuery | –£–¥–∞–ª–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å wp_enqueue_script('jquery') |
| `index.php` | –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞ –¥–ª—è –ø–ª–∞–≥–∏–Ω–∞ | –£–¥–∞–ª–∏—Ç—å |
| –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ price_editor.js | –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –≤ –∫–ª–∞—Å—Å—ã |
| Inline —Å—Ç–∏–ª–∏ –≤ HTML | –ü–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ | –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ CSS |
| console.log –æ—Ç–ª–∞–¥–∫–∞ | –ù–µ –Ω—É–∂–Ω–æ –≤ production | –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –æ–±–µ—Ä–Ω—É—Ç—å –≤ DEBUG —Ñ–ª–∞–≥ |

### –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

```javascript
// ‚ùå –£—Å—Ç–∞—Ä–µ–≤—à–∏–π jQuery –ø–∞—Ç—Ç–µ—Ä–Ω
$(document).ready(function() {
    // ...
});

// ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
document.addEventListener('DOMContentLoaded', () => {
    // ... –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å wp_add_inline_script —Å 'after'
});

// ‚ùå –£—Å—Ç–∞—Ä–µ–≤—à–∏–π var
var editor = new PriceEditor();

// ‚úÖ ES6+
const editor = new PriceEditor();

// ‚ùå –°—Ç—Ä–æ–∫–æ–≤–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è
var html = '<div class="' + className + '">' + content + '</div>';

// ‚úÖ Template literals
const html = `<div class="${className}">${content}</div>`;
```

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (Quick Wins)

1. **–í–∫–ª—é—á–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. **–î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. **–£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π jQuery** - —É–º–µ–Ω—å—à–∏—Ç —Ä–∞–∑–º–µ—Ä
4. **–î–æ–±–∞–≤–∏—Ç—å debounce –¥–ª—è –ø–æ–∏—Å–∫–∞** - —É–º–µ–Ω—å—à–∏—Ç –Ω–∞–≥—Ä—É–∑–∫—É

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–û–±—ä–µ–¥–∏–Ω–∏—Ç—å CSS —Ñ–∞–π–ª—ã** - —É–º–µ–Ω—å—à–∏—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã
2. **–î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —É—Å–∫–æ—Ä–∏—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
3. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å API –≤ –∫–ª–∞—Å—Å—ã** - —É–ª—É—á—à–∏—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å
4. **–î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã** - –ø–æ–≤—ã—Å–∏—Ç –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ REST API** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è
2. **–î–æ–±–∞–≤–∏—Ç—å WebSocket** - real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. **–í–Ω–µ–¥—Ä–∏—Ç—å TypeScript** - —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
4. **–°–æ–∑–¥–∞—Ç—å CI/CD pipeline** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É –¥–ª—è WordPress –ø–ª–∞–≥–∏–Ω–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–≥–∏–Ω–∞

```
woo-price-editor/
‚îú‚îÄ‚îÄ woo-price-editor.php           # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø–ª–∞–≥–∏–Ω–∞
‚îú‚îÄ‚îÄ uninstall.php                  # –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏
‚îú‚îÄ‚îÄ readme.txt                     # –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è WP.org
‚îú‚îÄ‚îÄ includes/
‚îÇ   ‚îú‚îÄ‚îÄ class-wpe-loader.php       # –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ class-wpe-activator.php    # –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ class-wpe-deactivator.php  # –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ class-wpe-admin.php        # –ê–¥–º–∏–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
‚îÇ   ‚îú‚îÄ‚îÄ class-wpe-api.php          # REST API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ class-wpe-product.php      # –†–∞–±–æ—Ç–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ class-wpe-security.php     # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îú‚îÄ‚îÄ class-wpe-admin-page.php   # –ê–¥–º–∏–Ω —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ partials/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ wpe-admin-display.php  # HTML —à–∞–±–ª–æ–Ω
‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ wpe-admin.css          # –°—Ç–∏–ª–∏ (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ)
‚îÇ   ‚îî‚îÄ‚îÄ js/
‚îÇ       ‚îú‚îÄ‚îÄ wpe-admin.js           # –°–∫—Ä–∏–ø—Ç—ã (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ)
‚îÇ       ‚îî‚îÄ‚îÄ wpe-modules/           # –ú–æ–¥—É–ª–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
‚îú‚îÄ‚îÄ languages/
‚îÇ   ‚îî‚îÄ‚îÄ woo-price-editor-ru_RU.po  # –ü–µ—Ä–µ–≤–æ–¥—ã
‚îî‚îÄ‚îÄ tests/
    ‚îú‚îÄ‚îÄ test-api.php
    ‚îî‚îÄ‚îÄ test-security.php
```

### –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø–ª–∞–≥–∏–Ω–∞

```php
<?php
/**
 * Plugin Name: WooCommerce Price Editor
 * Plugin URI: https://example.com/woo-price-editor
 * Description: Bulk edit WooCommerce product prices with advanced filtering
 * Version: 1.0.0
 * Requires at least: 5.8
 * Requires PHP: 7.4
 * Author: Your Name
 * Author URI: https://example.com
 * License: GPL v2 or later
 * License URI: https://www.gnu.org/licenses/gpl-2.0.html
 * Text Domain: woo-price-editor
 * Domain Path: /languages
 * WC requires at least: 5.0
 * WC tested up to: 8.0
 */

// –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
if (!defined('ABSPATH')) {
    exit;
}

// –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø–ª–∞–≥–∏–Ω–∞
define('WPE_VERSION', '1.0.0');
define('WPE_PLUGIN_DIR', plugin_dir_path(__FILE__));
define('WPE_PLUGIN_URL', plugin_dir_url(__FILE__));
define('WPE_PLUGIN_BASENAME', plugin_basename(__FILE__));

// –ü—Ä–æ–≤–µ—Ä–∫–∞ WooCommerce
function wpe_check_woocommerce() {
    if (!class_exists('WooCommerce')) {
        add_action('admin_notices', function() {
            echo '<div class="error"><p>';
            echo esc_html__('WooCommerce Price Editor requires WooCommerce to be installed and active.', 'woo-price-editor');
            echo '</p></div>';
        });
        return false;
    }
    return true;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞
function wpe_init() {
    if (!wpe_check_woocommerce()) {
        return;
    }
    
    require_once WPE_PLUGIN_DIR . 'includes/class-wpe-loader.php';
    
    $plugin = new WPE_Loader();
    $plugin->run();
}
add_action('plugins_loaded', 'wpe_init');

// –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è
register_activation_hook(__FILE__, 'wpe_activate');
register_deactivation_hook(__FILE__, 'wpe_deactivate');

function wpe_activate() {
    require_once WPE_PLUGIN_DIR . 'includes/class-wpe-activator.php';
    WPE_Activator::activate();
}

function wpe_deactivate() {
    require_once WPE_PLUGIN_DIR . 'includes/class-wpe-deactivator.php';
    WPE_Deactivator::deactivate();
}
```

### REST API –∫–ª–∞—Å—Å

```php
<?php
class WPE_API {
    private $namespace = 'woo-price-editor/v1';
    
    public function register_routes() {
        register_rest_route($this->namespace, '/products', [
            'methods' => WP_REST_Server::READABLE,
            'callback' => [$this, 'get_products'],
            'permission_callback' => [$this, 'check_permission'],
            'args' => $this->get_products_args()
        ]);
        
        register_rest_route($this->namespace, '/products/(?P<id>\d+)', [
            'methods' => WP_REST_Server::EDITABLE,
            'callback' => [$this, 'update_product'],
            'permission_callback' => [$this, 'check_permission'],
            'args' => $this->get_update_args()
        ]);
        
        register_rest_route($this->namespace, '/categories', [
            'methods' => WP_REST_Server::READABLE,
            'callback' => [$this, 'get_categories'],
            'permission_callback' => [$this, 'check_permission']
        ]);
        
        register_rest_route($this->namespace, '/tax-classes', [
            'methods' => WP_REST_Server::READABLE,
            'callback' => [$this, 'get_tax_classes'],
            'permission_callback' => [$this, 'check_permission']
        ]);
    }
    
    public function check_permission() {
        return current_user_can('manage_woocommerce');
    }
    
    public function get_products(WP_REST_Request $request) {
        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    }
    
    public function update_product(WP_REST_Request $request) {
        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    }
}
```

### JavaScript –º–æ–¥—É–ª—å (ES6+)

```javascript
/**
 * WooCommerce Price Editor - Main Module
 */
(function($) {
    'use strict';
    
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    const config = {
        apiUrl: wpeData.restUrl,
        nonce: wpeData.nonce,
        pageLength: 50,
        debounceDelay: 300
    };
    
    // API –∫–ª–∏–µ–Ω—Ç
    const api = {
        request(endpoint, method = 'GET', data = null) {
            return $.ajax({
                url: `${config.apiUrl}${endpoint}`,
                method,
                beforeSend: (xhr) => {
                    xhr.setRequestHeader('X-WP-Nonce', config.nonce);
                },
                contentType: 'application/json',
                data: data ? JSON.stringify(data) : null
            });
        },
        
        getProducts(params) {
            const query = new URLSearchParams(params).toString();
            return this.request(`/products?${query}`);
        },
        
        updateProduct(id, data) {
            return this.request(`/products/${id}`, 'PATCH', data);
        }
    };
    
    // UI –º–æ–¥—É–ª—å
    const ui = {
        showNotification(message, type = 'success') {
            // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        },
        
        showError(message) {
            this.showNotification(message, 'error');
        }
    };
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DataTable
    function initDataTable() {
        return $('#wpe-products-table').DataTable({
            serverSide: true,
            processing: true,
            pageLength: config.pageLength,
            ajax: {
                url: `${config.apiUrl}/products`,
                type: 'GET',
                beforeSend: (xhr) => {
                    xhr.setRequestHeader('X-WP-Nonce', config.nonce);
                },
                data: (d) => ({
                    page: Math.floor(d.start / d.length) + 1,
                    per_page: d.length,
                    search: d.search.value,
                    orderby: d.columns[d.order[0].column].data,
                    order: d.order[0].dir
                }),
                dataSrc: (json) => json.products
            },
            columns: [
                // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫
            ]
        });
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    $(document).ready(() => {
        if ($('#wpe-products-table').length) {
            initDataTable();
        }
    });
    
})(jQuery);
```

---

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã |
|---|--------|-----------|--------------|
| 1 | –î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É (nonce) | üî¥ P0 | 2—á |
| 2 | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –≤—Å–µ—Ö API endpoints | üî¥ P0 | 2—á |
| 3 | –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π SQL injection | üî¥ P0 | 2—á |
| 4 | –î–æ–±–∞–≤–∏—Ç—å XSS –∑–∞—â–∏—Ç—É –≤ JS | üî¥ P0 | 2—á |

### –§–∞–∑–∞ 2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (2-3 –¥–Ω—è)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã |
|---|--------|-----------|--------------|
| 5 | –í–∫–ª—é—á–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é –ø–∞–≥–∏–Ω–∞—Ü–∏—é | üü† P1 | 4—á |
| 6 | –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π/–∫–ª–∞—Å—Å–æ–≤ | üü† P1 | 2—á |
| 7 | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å SQL –∑–∞–ø—Ä–æ—Å—ã | üü† P1 | 4—á |
| 8 | –û–±—ä–µ–¥–∏–Ω–∏—Ç—å CSS —Ñ–∞–π–ª—ã | üü° P2 | 2—á |

### –§–∞–∑–∞ 3: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (3-5 –¥–Ω–µ–π)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã |
|---|--------|-----------|--------------|
| 9 | –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π jQuery | üü° P2 | 1—á |
| 10 | –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π API –∫–ª–∏–µ–Ω—Ç JS | üü° P2 | 4—á |
| 11 | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å PHP API –≤ –∫–ª–∞—Å—Å—ã | üü° P2 | 8—á |
| 12 | –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö | üü° P2 | 4—á |

### –§–∞–∑–∞ 4: WordPress –ø–ª–∞–≥–∏–Ω (5-7 –¥–Ω–µ–π)

| # | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã |
|---|--------|-----------|--------------|
| 13 | –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–ª–∞–≥–∏–Ω–∞ | üü¢ P3 | 4—á |
| 14 | –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–∞ REST API | üü¢ P3 | 8—á |
| 15 | –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã (i18n) | üü¢ P3 | 4—á |
| 16 | –ù–∞–ø–∏—Å–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é | üü¢ P3 | 4—á |
| 17 | –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã | üü¢ P3 | 8—á |

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç

| –§–∞–∑–∞ | –í—Ä–µ–º—è | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|------|-------|-----------|
| –§–∞–∑–∞ 1 | 8 —á–∞—Å–æ–≤ | –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥ |
| –§–∞–∑–∞ 2 | 12 —á–∞—Å–æ–≤ | –ë—ã—Å—Ç—Ä—ã–π –∫–æ–¥ |
| –§–∞–∑–∞ 3 | 17 —á–∞—Å–æ–≤ | –ß–∏—Å—Ç—ã–π –∫–æ–¥ |
| –§–∞–∑–∞ 4 | 28 —á–∞—Å–æ–≤ | WordPress –ø–ª–∞–≥–∏–Ω |
| **–ò—Ç–æ–≥–æ** | **~65 —á–∞—Å–æ–≤** | **–ì–æ—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç** |

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:

1. **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** - —Ü–µ–ª—å < 2 —Å–µ–∫—É–Ω–¥
2. **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API** - —Ü–µ–ª—å < 500–º—Å
3. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤** - —Ü–µ–ª—å < 15
4. **–†–∞–∑–º–µ—Ä JS/CSS** - —Ü–µ–ª—å < 200KB (gzipped)
5. **–û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏** - —Ü–µ–ª—å: 0

---

## üìé –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### A. –ß–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º

- [ ] –í—Å–µ API endpoints –∑–∞—â–∏—â–µ–Ω—ã nonce
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –≤—Å–µ—Ö endpoints
- [ ] –í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç prepare()
- [ ] –í—Å–µ –≤—ã–≤–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è
- [ ] –û—Ç–∫–ª—é—á–µ–Ω debug —Ä–µ–∂–∏–º
- [ ] –£–¥–∞–ª–µ–Ω—ã console.log
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω rate limiting
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

### B. –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- [ ] –°–µ—Ä–≤–µ—Ä–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] CSS/JS –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- [ ] Gzip –≤–∫–ª—é—á—ë–Ω
- [ ] Lazy loading –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤

### C. –ß–µ–∫-–ª–∏—Å—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ WP 5.8+
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ WC 5.0+
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ PHP 7.4, 8.0, 8.1, 8.2
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Chrome, Firefox, Safari, Edge
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

---

*–û—Ç—á—ë—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ WordPress –ø–ª–∞–≥–∏–Ω–∞ woo-price-editor.*
